<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Viewer</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  .video-container { margin-bottom: 30px; }
  video { width: 100%; max-width: 600px; display: block; margin-bottom: 10px; }
  .info { margin-bottom: 10px; }
  button { margin-right: 10px; padding: 5px 10px; }
</style>
</head>
<body>

<h1>My Video Site</h1>

<div id="videos"></div>

<script>
// Sample JSON data
const videoData = [
  {
    "videoname": "Video test",
    "filename": "videotest.mp4",
    "author": "Jvideo",
    "views": 0,
    "likes": 0
  }
];

// Render videos
function renderVideos() {
  const container = document.getElementById('videos');
  container.innerHTML = '';

  videoData.forEach((video, index) => {
    const videoDiv = document.createElement('div');
    videoDiv.classList.add('video-container');

    // Check localStorage for user status
    const userStatus = JSON.parse(localStorage.getItem(`video-${index}`)) || { viewed: false, liked: false };

    videoDiv.innerHTML = `
      <h2>${video.videoname}</h2>
      <video id="video-${index}" src="${video.filename}" controls></video>
      <div class="info">
        Author: ${video.author} <br>
        Views: <span id="views-${index}">${video.views + (userStatus.viewed ? 1 : 0)}</span> 
        Likes: <span id="likes-${index}">${video.likes + (userStatus.liked ? 1 : 0)}</span>
      </div>
      <button id="like-btn-${index}" ${userStatus.liked ? 'disabled' : ''}>Like</button>
    `;

    container.appendChild(videoDiv);

    // Add view when video starts playing (only once per user)
    const videoEl = document.getElementById(`video-${index}`);
    videoEl.addEventListener('play', () => {
      if (!userStatus.viewed) {
        userStatus.viewed = true;
        localStorage.setItem(`video-${index}`, JSON.stringify(userStatus));
        document.getElementById(`views-${index}`).innerText = video.views + 1;
      }
    });

    // Like button click
    const likeBtn = document.getElementById(`like-btn-${index}`);
    likeBtn.addEventListener('click', () => {
      if (!userStatus.liked) {
        userStatus.liked = true;
        localStorage.setItem(`video-${index}`, JSON.stringify(userStatus));
        document.getElementById(`likes-${index}`).innerText = video.likes + 1;
        likeBtn.disabled = true;
      }
    });
  });
}

// Initial render
renderVideos();
</script>

</body>
</html>
